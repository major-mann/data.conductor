'use strict';(function(B){var z;B("jsdc",["angular"],function(B){z=B;z.V("dataConductor",[]);(function(t){t.Y("jsdcObjectStorageService",function(){return function(){function q(c){return d[c]||null}function l(c){var l=q(c);delete d[c];return l||null}function n(c){if(!c||"object"!==typeof c)throw Error("adapter MUST be an object");v.Ga.forEach(function(d){if("function"!==typeof c[d])throw Error('Object invalid. A function named "'+d+'" is expected to exist on the adapter');});v.ka.forEach(function(d){if(c.hasOwnProperty(d)&&
"function"!==typeof c[d])throw Error('Object invalid. When supplied on the adapter, the property named "'+d+'" MUST be a function');});v.Wa.forEach(function(d){var p=c[d];if(!p||"object"!==typeof p)throw Error('Object invalid. An object property named "'+d+'" is expected to exist on the adapter');})}var v=this,d={};this.Ga=[];this.ka=[];this.Wa=[];this.add=function(c,l){var p;a:{p=typeof c;null===c&&(p="null");switch(p){case "string":case "number":case "boolean":case "undefined":case "null":p=!0;
break a;case "function":case "object":p=!1;break a}p=void 0}if(!p)throw Error("name MUST be a value type");if(d[c])throw Error('object named "'+c+'" already exists');n(l);return d[c]=l};this.remove=l;this.all=function(){return Object.keys(d).map(function(c){return{name:c,o:d[c]}})};this.find=q;this.Ab=n;this.clear=function(){v.all().map(function(c){return c.name}).forEach(l)}}})})(z.V("dataConductor"));(function(t){t.Y("jsdcAdapterService",["jsdcObjectStorageService",function(q){function l(){q.call(this);
this.Ga.push("find");this.ka.push("count");this.ka.push("info")}l.global=new l;return l}])})(z.V("dataConductor"));(function(t){t.Y("jsdcIndexedCollection",function(){return function(q,l){function n(a,b,f){var k=c(a,f);if(a===q&&e[a][k]&&e[a][k].value===f&&-1<e[a][k].keys.indexOf(b))throw Error('cannot add duplicate primary key ("'+b+'")!');e[a][k]&&e[a][k].value===f||e[a].splice(k,0,{value:f,keys:[]});e[a][k].keys.push(b)}function v(a,b,f){var k=e[a];a=c(a,f);k[a]&&k[a].value===f&&(f=k[a].keys,b=
f.indexOf(b),-1<b&&(f.splice(b,1),f.length||k.splice(a,1)))}function d(a,b){var f=c(a,b);return e[a][f]&&e[a][f].value===b?e[a][f].keys:null}function c(a,b){function f(a,b,w,k){var e,c;w===k?a[w]&&a[w].value<b&&w++:(e=Math.floor(w/2+k/2),c=a[e].value,c===b?w=e:c<b?(e+1<=k&&e++,w=f(a,b,e,k)):(e-1>=w&&e--,w=f(a,b,w,e)));return w}var k=e[a];return k.length?f(k,b,0,k.length-1):0}function u(a,b,f){function k(e){var c=a[e];return c?b[c]>f[c]?1:b[c]<f[c]?-1:k(e+1):0}return k(0)}function p(a){return r[a]}
var t=0,r={},y={},e={},b;if(!q||"string"!==typeof q)throw Error("primary MUST be a non empty string");if(!Array.isArray(l))throw Error("fields MUST be an array");l=l.slice();l.unshift(q);for(b=0;b<l.length;b++)e[l[b]]=[];this.find=function(a,b){var f;if(1===arguments.length)b=a,a=q;else if(!e[a])throw Error('index named "'+a+'" does not exist');f=d(a,b);null===f&&(f=[]);return f.map(function(a){return r[a]})};this.la=function(a){return r[a]||null};this.add=function(a){var b=a[q],f={};l.forEach(function(b){f[b]=
a[b]});r[b]=a;y[b]=f;l.forEach(function(f){n(f,b,a[f])});t++};this.remove=function(a){var b;l.forEach(function(b){v(b,a,y[a][b])});delete y[a];b=r[a];delete r[a];t--;return b};this.count=function(){return t};this.update=function(a){var b=a[q];l.forEach(function(f){var e=y[b][f],c=a[f];e!==c&&(v(f,b,e),n(f,b,c));y[b][f]=a[f]})};this.all=function(a){function b(w){return w.keys.map(p).sort(u.bind(null,a))}Array.isArray(a)||(a=[a]);a=a.slice();var f=a[0]||q,c;-1===a.indexOf(q)&&a.push(q);if(e[f])return a.shift(),
c=e[f].map(b),f=[],f=f.concat.apply(f,c);throw Error('index named "'+f+'" could not be found!');};this.clear=function(){t=0;r={};y={};l.forEach(function(a){e[a]=[]})};this.min=function(a,b){function f(a){return a.keys}var c,d;1===arguments.length&&(b=a,a=q);b=b||1;if(1>b)throw Error("supplied count MUST be greater than 0");if(e[a])d=e[a].slice(0,b),d=d.map(f),c=[],c=c.concat.apply(c,d);else throw Error('index named "'+a+'" could not be found!');c=c.slice(0,b);return c.map(p)};this.max=function(a,
b){var f,c;1===arguments.length&&(b=a,a=q);b=b||1;if(1>b)throw Error("supplied count MUST be greater than 0");if(e[a])f=e[a].length-1,c=e[a].slice(f-b,f),f=[],f=f.concat.apply(f,c);else throw Error('index named "'+a+'" could not be found!');f=f.slice(f.length-b,f.length);return f.map(p)};this.oa=function(a,b){function f(a){return a.keys}var k,d;1===arguments.length&&(b=a,a=q);if(e[a])k=c(a,b),k=e[a].slice(0,k).map(f),d=[],d=d.concat.apply(d,k);else throw Error('index named "'+a+'" could not be found!');
return d};this.Ja=function(a,b){function f(a){return a.keys}var k,d;1===arguments.length&&(b=a,a=q);if(e[a])d=e[a].length,k=c(a,b),e[a][k]&&e[a][k].value===b&&k++,k=e[a].slice(k,d).map(f),d=[],d=d.concat.apply(d,k);else throw Error('index named "'+a+'" could not be found!');return d}}})})(z.V("dataConductor"));(function(t){t.Y("jsdcQueue",[function(){return function(){function q(){var d;l?(d=l.data,(l=l.next)||(n=null),v--):d=null;return d}var l=null,n=null,v=0;this.ab=function(d){null===l?l=n={data:d,
next:null}:n=n.next={data:d,next:null};v++};this.qb=function(d){null===l?l=n={data:d,next:null}:l={data:d,next:l};v++};this.Za=q;this.remove=function(d){var c=l;if(c.data===d)return q();for(;c.next;){if(c.next.data===d)return c.next=c.next.next||null,v--,d;c=c.next}return null};this.pb=function(){var d,c,n=l;d=d||0;for(c=0;c<d&&n;c++)n=n.next;return n?n.data:null};this.count=function(){return v};this.all=function(){for(var d=[],c=l;c;)d.push(c.data),c=c.next;return d}}}])})(z.V("dataConductor"));
(function(t){t.Y("jsdcIndexedPageCache",["jsdcEventEmitter","jsdcIndexedCollection",function(q,l){function n(){function p(a,c,f,e,d){y=(y+1)%(Number.fa||Number.MAX_VALUE);a={index:a,v:c,O:f,F:e,data:d,La:null,G:y};b.items.add(a);return a}function t(a,c){function f(b){l(b.length,function(c){l(a,q.bind(null,b[c]*a))})}function d(b){n(b.length,function(c){n(a,q.bind(null,b[c]*a))})}function l(a,b){for(var c=0;c<a;c++)b(c)}function n(a,b){for(var c=a-1;0<=c;c--)b(c)}function q(x,f){var g=x+f,d=x+f,k=
a,m=c,h,l;k||(k=e.j());m||(m=e.j());h=Math.floor(g/k);g%=k;l=Math.floor(d/m);d%=m;if(h!==l||g!==d)if(h=b.items.la(h)){for(;h.data.length<k;)h.data.push(v);var n=b.items.la(l),m=Date.now(),u,A,k=h?h.data.length:e.j();if(n)h&&(l=1/k,k=1-l,u=h.v*l+n.v*k,m=h.F*l+n.F*k,A=h.O*l+n.O*k,n.v=u,n.O=A,n.F=m);else{u=h?h.v:1;A=h?h.O:m;m=h?h.F:m;n=u;u=A;var r=[];for(A=0;A<k;A++)r.push(v);n=p(l,n,u,m,r)}n.data[d]=h.data[g];h.data[g]=v}else(g=b.items.la(l))&&(g.data[d]=v)}function u(a){for(var b=0;b<g.length;b++)for(;g[b].data.length<
a;)g[b].data.push(v)}var r,m,g;a!==c&&(r=b.items.Ja(-1),m=b.items.oa(0),a>c?(d(r),f(m)):(g=b.items.all(),u(c),f(r),d(m)),g=b.items.all(),l(g.length,function(a){for(;g[a].data.length>c;)g[a].data.pop();-1<g[a].data.indexOf(v)&&b.items.remove(g[a].index)}))}function r(a){function d(a){b.items.remove("number"===typeof a?a:a.index)}var f=e.count();if(a<f){switch(e.C()){case c.O:a=b.items.min("stored",f-a);break;case c.F:a=b.items.min("modified",f-a);break;case c.v:a=b.items.min("touched",f-a);break;case c.G:a=
b.items.min("order",f-a);break;default:if("function"===typeof e.C())a=e.C()(b.items,a);else throw Error('Unrecognized purge mode "'+e.C()+'". Must be one of the following '+Object.keys(c).join(", ")+" or a function to be called with the items and count,  expecting an array of indexes to be removed to be returned.");}a.forEach(d)}}var y=0,e=this,b={items:new l("index",["touched","stored","modified","order"]),m:n.kb,C:n.Bb,B:n.hb,D:n.Sa,j:n.zb};q.call(this);this.ba=c;this.$=d;this.R=u;this.j=function(){return b.j};
this.za=function(a){var c;a=Math.floor(a);if(a!==b.j){if(0<a)e.D()===u.clear?b.items.clear():(t(b.j,a),r(e.m()));else throw Error("pageSize MUST be a positive integer");c=b.j;b.j=a;e.b("pageSizeChanged",a,c)}return a};this.D=function(){return b.D};this.Ba=function(a){var c;if(u[a])c=b.D,b.D=a,c!==a&&e.b("resizeChanged",a,c);else throw Error("resizeMode invalid. MUST be one of the following value: "+Object.keys(u).join(", ")+'. Got "'+a+'"');};this.B=function(){return b.B};this.wa=function(a){function c(a){b.items.remove(a)}
var f;if(d[a])a!==b.B&&(a===d.ia&&(f=b.items.oa(0),f.forEach(c)),f=b.B,b.B=a,e.b("indexModeChanged",a,f));else throw Error("invalid indexMode value. MUST be one of the following value: "+Object.keys(d).join(", ")+'. Got "'+a+'"');};this.m=function(){return b.m};this.Pa=function(a){var c=e.m();a=a+1-1;if(0<a)a=Math.floor(a),r(a),b.m=a;else throw Error("maxItems MUST be a number greater than 0");c!==a&&e.b("maxItemsChanged",a,c);return b.m};this.C=function(){return b.C};this.Qa=function(a){var d=e.C();
if(c[a])b.C=a;else if("function"===typeof a)b.C=a;else throw Error('invalid purgeMode value "'+a+'". MUST be one of the following: "'+Object.keys(c)+'"');d!==a&&e.b("purgeModeChanged",a,d)};this.state=function(){return{m:e.m(),C:e.C(),B:e.B(),D:e.D(),j:e.j()}};this.ca=function(a){if(!a||"object"!==typeof a)throw Error("supplied state MUST be an object");a.hasOwnProperty("maxItems")&&e.Pa(a.m);a.hasOwnProperty("purgeMode")&&e.Qa(a.C);a.hasOwnProperty("indexMode")&&e.wa(a.B);a.hasOwnProperty("resizeMode")&&
e.Ba(a.D);a.hasOwnProperty("pageSize")&&e.za(a.j)};this.f=function(a,c){var f;a=a+1-1;if(isNaN(a))throw Error("index MUST be a number");if(!Array.isArray(c))throw Error("cached items MUST be arrays");if(b.B===d.ia&&0>a)throw Error('index MUST be greater than or equal to 0 when indexMode is "positive"');f=b.items.find(a);f.length?(f[0].v++,f[0].F=(new Date).getTime(),f[0].data=c,b.items.update(f[0])):(p(a,1,(new Date).getTime(),(new Date).getTime(),c),r(e.m()),e.b("cached",c));return c};this.yb=function(a){a=
(a=b.items.remove(a))&&a.data;e.b("uncached",a);return a};this.count=function(){return b.items.count()};this.T=function(a){return b.items.all(a||"index").map(function(a){return{O:a.O,F:a.F,v:a.v,data:a.data,index:a.index}})};this.data=function(a){a=b.items.find(a);var c=a[0]&&a[0].data;a[0]&&(a[0].v++,b.items.update(a[0]));return c||null};this.info=function(a){a=b.items.find(a);var c=null;a[0]&&(c={v:a[0].v,O:a[0].O,F:a[0].F,G:a[0].G});return c};this.La=function(a){a=b.items.find(a);var c;a[0]?c=
a[0].La:c=null;return c};this.clear=b.items.clear}var v={},d={ia:"positive",Cb:"full"},c={O:"stored",F:"modified",v:"touched",G:"order"},u={clear:"clear",mb:"maintain"};n.kb=Number.MAX_VALUE;n.zb=10;n.Bb=c.v;n.hb=d.ia;n.Sa=u.clear;n.ba=c;n.$=d;n.R=u;return n}])})(z.V("dataConductor"));(function(t){t.Y("jsdcEventEmitter",[function(){return function(){function q(n,q){var d;l[n]?d=l[n]:("boolean"===typeof q?q:1)?(d=[],l[n]=d):d=null;return d}var l={};this.h=function(l,v){q(l).push(v)};this.b=function(l){function v(d){try{try{d.apply(d,
c)}catch(l){console.warn("Event handler raised an error!"),console.error(l)}}catch(n){console.error("event handler caused error"),console.log(n)}}var d=q(l,!1),c;d&&(c=Array.prototype.slice(arguments),c.shift(),d.forEach(v))}}}])})(z.V("dataConductor"));(function(t,q){q.Y("jsdcLoaderService",["$timeout","$q","jsdcEventEmitter","jsdcAdapterService","jsdcQueue","jsdcIndexedPageCache",function(l,n,q,d,c,u){function p(){function a(){m.f().clear();m.info().forEach(function(a){a.cancel()})}function w(a){a=
m.info(a);return a.T||a.g||a.Ma||a.i}function f(a){function b(a){return parseInt(a,10)}var c,f,e,d,h;f=[];c=Object.keys(a).map(b);e=g.f.T();h=e.map(E);h=h.concat(c);h=h.concat(Object.keys(g.g).map(b));h=h.concat(Object.keys(g.i).map(b));h=h.filter(function(a,b,c){return c.indexOf(a)===b});for(c=0;c<h.length;c++)d=c<e.length?e[c]:null,d=k(h[c],d,a[h[c]],g.g[h[c]],g.i[h[c]]),f.push(d);f.sort(function(a,b){return a.index-b.index});return f}function k(a,b,c,f,e){var d=null,h,g;b||(d=c||f||e);d?(h=d.loaded.H,
g=d.cancel):(h=n.defer(),h.resolve(b||null),h=h.H,g=G);return{index:a,cb:!!b||!!f||!!e||!!c,T:b,l:d&&d.l||!1,g:!!f,i:!!e,Ma:!!c,cancel:g,loaded:h}}function F(){function a(b){var c,f,d,e,x,k,l,n=h.c.map(E);h.l=!0;f=Math.min.apply(Math,n);for(c=0;c<h.c.length;c++)x=h.c[c],k=Math.floor(x.index/x.count),delete g.g[k],d=x.index-f,e=d+x.count,m.A()===r.ha&&null!==m.f().info(k)||m.f().f(k,b.slice(d,e));for(c=0;c<h.c.length;c++)x=h.c[c],d=x.index-f,e=d+x.count,l=b.slice(d,e),k=Math.floor(x.index/x.count),
m.b("loaded",k,l),x.loaded.resolve(b.slice(d,e));b={Db:n,data:b};w.resolve(b);m.b("executed",b)}function b(a){function c(a){var b;b=h.c[a].index/h.c[a].count;g.i[b].splice(g.i[b].indexOf(h.c[a]),1);0===g.i[b].length&&delete g.i[b];f(h.c[a])}var d,x,e;h.l=!0;for(d=0;d<h.c.length;d++)h.c[d].Na?(h.c[d].Na--,x=m.N(),c=f.bind(null,h.c[d]),e=Math.floor(h.c[d].index/h.c[d].count),Array.isArray(g.i[e])||(g.i[e]=[]),g.i[e].push(h.c[d]),x?l(c.bind(null,d),x):c()):f(h.c[d],a);w.reject(a)}function c(a){function b(a){return!a.l}
var d;if(!h.l)if(m.w()===e.all){h.l=!0;h.cancel.resolve();for(d=0;d<h.c.length;d++)f(h.c[d],h.c[d].index===a?"cancelled":!1);w.reject("cancelled")}else if(m.w()===e.ha)for(d=h.c.filter(b),1===d.length&&(h.l=!0,h.cancel.resolve(),w.reject("cancelled")),d=0;d<h.c.length;d++)h.c.index===a&&f(h.c[d],"cancelled");else throw Error('unrecognised batch cancel mode "'+m.w()+'"');}function f(a,b){b?(a.l=!0,a.loaded.reject(b)):(a.g=!1,a.l=!1,g.u.qb(a),m.P()===y.Ha?m.ga(!0):m.ga());delete g.g[Math.floor(a.index/
a.count)]}var d,k,h,w;if(!g.I)throw Error("adapter has not been set. You must set an adapter before calling execute.");for(h=C();null===h&&g.u.count();)h=C();w=n.defer();if(h){for(d=0;d<h.c.length;d++)k=Math.floor(h.c[d].index/h.c[d].count),g.g[k]=h.c[d],h.c[d].g=!0,h.c[d].Ra&&h.c[d].Ra.then(c.bind(null,h.c[d].index));h.cancel=n.defer();d=g.I.find(g.filter,{Hb:h.index,Eb:h.count,cancel:h.cancel.H});d.then(a).catch(b)}else w.resolve([]);return w.H}function C(){function a(b,c){b.index===c.index?b.count=
Math.max(b.count,c.count):(b.count+=c.count,c.index<b.index&&(b.index-=c.count));b.c.push(c)}function b(a,c){var d=!1;m.J()&&c&&c!==z&&a.count<m.S()&&(d=a.index===c.index||a.index+a.count===c.index||a.index-c.count===c.index);return d}for(var c,d,f=null;!f||b(f,g.u.pb());){c=g.u.Za();if(!c||c===z)break;f||(f={index:c.index,count:0,c:[],l:!1});a(f,c)}f&&1===f.c.length&&m.A()===r.ha&&(d=Math.floor(f.index/f.count),c=w(d))&&(m.b("ignored",d),Array.isArray(c)?f.c[0].loaded.resolve(c):c.loaded.H.then(f.c[0].loaded.resolve).catch(f.c[0].loaded.reject),
f=null);return f}function D(){function a(b){return this[b]}function b(a,c){return a.G-c.G}var c=g.u.count()+Object.keys(g.g).length+Object.keys(g.i).length,d=m.L();if(c>d)for(c=g.u.all().concat(Object.keys(g.g).map(a.bind(g.g))).concat(Object.keys(g.g).map(a.bind(g.i))),c.sort(b);c.length>d;)c[0].cancel(),c.shift()}function E(a){return a.index}function G(){}var m=this,g={G:0,o:null,I:null,filter:null,f:new u,u:new c,pa:0,g:{},i:{},A:p.gb,P:p.eb,s:p.Fa,J:p.fa,M:p.Ta,N:p.Ua,w:p.Xa,S:p.Ea,L:p.ib,U:p.jb};
q.call(this);this.aa=r;this.Z=y;this.f=function(){return g.f};this.o=function(){return g.o};this.I=function(){return g.I};this.ra=function(a){var b,c;if("string"===typeof a){if(b=d.global.find(a),!b)throw Error('adapter named "'+a+'" not found!');}else if("object"===typeof a)d.global.Ab(a),b=a;else throw Error('invalid adapter value. MUST be a string or an object. Got a "'+typeof a+'"');c=g.o;g.o=a;a!==c&&m.b("adapterChanged",a,c);g.I=b};this.filter=function(){return g.filter};this.ja=function(b){var c;
t.bb(g.filter,b)||(c=g.filter,g.filter=b,a(),m.b("filterChanged",b,c))};this.s=function(){return g.s};this.Aa=function(a){var b;if(1<=a)b=g.s,b!==a&&(g.s=a,m.b("parallelChanged",a,b));else throw Error("parallel MUST be a number greater than or equal to 1");};this.J=function(){return g.J};this.ua=function(a){var b=g.J;a!==b&&(g.J=a,m.b("batchingChanged",a,b))};this.w=function(){return g.w};this.sa=function(a){var b;if(e[a])b=g.w,a!==b&&(g.w=a,m.b("batchCancelModeChanged",a,b));else throw Error('invalid batchCancelMode value "'+
a+'". Must be one of the following: '+Object.keys(e).join(", "));};this.S=function(){return g.S};this.L=function(){return g.L};this.xa=function(a){var b;if(0<a)b=g.L,b!==a&&(g.L=a,D(),m.b("loadMaxChanged",a,b));else throw Error("loadMax MUST be a number greater than 0");};this.U=function(){return g.U};this.ya=function(a){var c;if(b[a])c=g.U,a!==c&&(g.U=a,m.b("loadOverflowModeChanged",a,c));else throw Error('invalid loadOverflowMode value "'+a+'". Must be one of the following: '+Object.keys(b).join(", "));
};this.ta=function(a){if(0<a)g.S=a;else throw Error("batchMax MUST be a number greater than 0");};this.P=function(){return g.P};this.Oa=function(a){var b;if(y[a])b=g.P,a!==b&&(g.P=a,m.b("executionModeChanged",a,b));else throw Error('invalid executionMode value "'+a+'". Must be one of the following: '+Object.keys(y).join(", "));};this.A=function(){return g.A};this.va=function(a){var b;if(r[a])b=g.A,a!==b&&(g.A=a,m.b("existingModeChanged",a,b));else throw Error('invalid existing mode value "'+a+'". MUST be one of the following: '+
Object.keys(r).join(", "));};this.N=function(){return g.N};this.Da=function(a){var b;if(0<=a)b=g.N,a!==b&&(g.N=a,m.b("retryDelayChanged",a,b));else throw Error("retryDelay MUST be number greater than or equal to 0");};this.M=function(){return g.M};this.Ca=function(a){var b;if(0<=a)b=g.M,a!==b&&(g.M=a,m.b("retryCountChanged",a,b));else throw Error("retryCount MUST be number greater than or equal to 0");};this.state=function(){return{o:m.o(),filter:m.filter(),A:m.A(),P:m.P(),s:m.s(),J:m.J(),M:m.M(),
N:m.N(),w:m.w()}};this.ca=function(a){if(!a||"object"!==typeof a)throw Error("supplied state MUST be an object");a.hasOwnProperty("adapter")&&m.ra(a.o);a.hasOwnProperty("filter")&&m.ja(a.filter);a.hasOwnProperty("existingMode")&&m.va(a.A);a.hasOwnProperty("executionMode")&&m.Oa(a.P);a.hasOwnProperty("parallel")&&m.Aa(a.s);a.hasOwnProperty("batching")&&m.ua(a.J);a.hasOwnProperty("batchMax")&&m.ta(a.S);a.hasOwnProperty("loadMax")&&m.xa(a.L);a.hasOwnProperty("loadOverflowMode")&&m.ya(a.U);a.hasOwnProperty("retryCount")&&
m.Ca(a.M);a.hasOwnProperty("retryDelay")&&m.Da(a.N);a.hasOwnProperty("batchCancelMode")&&m.sa(a.w)};this.load=function(a,c){function d(){e.resolve();k.l||(k.l=!0,k.g||g.u.remove(k))}var f,e,k,h;a=parseInt(a,10);if(isNaN(a))throw Error("supplied index MUST be a number");f=n.defer();if(m.A()===r.Ia&&(h=m.info(a),h.cb&&!h.l))return m.b("dropped",a),h.T?f.resolve(h.T):h.loaded.then(f.resolve).catch(f.reject),f.H;g.G=(g.G+1)%(Number.fa||Number.MAX_VALUE);h=g.f.j();e=n.defer();k={index:a*h,G:g.G,loaded:f,
cancel:d,Ra:e.H,l:!1,Na:m.M(),g:!1,count:h};if(c)if("function"===typeof c.then)c.then(d);else throw Error("when supplied, cancel MUST be a promise");g.u.ab(k);if(g.u.count()+Object.keys(g.g).length+Object.keys(g.i).length>m.L())if(m.U()===b.cancel)D(m.L());else throw Error("loadMax loads reached. Wait until some loads have completed before attempting to load new records.");g.P===y.Ka&&m.ga();return f.H};this.info=function(a){var b=g.u.all(),c,d={},e;for(c=0;c<b.length;c++)e=Math.floor(b[c].index/
b[c].count),d[e]=b[c];0<arguments.length?(b=m.f().data(a),d=k(a,b,d[a],g.g[a],g.i[a])):d=f(d);return d};this.ga=function(a){function b(){for(var a=m.s();g.pa<a&&g.u.count();)c()}function c(){g.pa++;F().then(d).fb(f)}function d(a){h.push(a)}function f(){g.pa--;!a&&g.u.count()?b():e.resolve(h)}var e,h=[];e=n.defer();g.u.count()?a?c():b():e.resolve(h);return e.H};this.clear=a}var z={},r=p.aa={replace:"replace",ha:"ignore",Ia:"drop"},y=p.Z={Ka:"instant",Ha:"delayed"},e=p.da={all:"all",ha:"ignore"},b=
p.ea={error:"error",cancel:"cancel"};p.Fa=1;p.fa=!1;p.Ua=2E3;p.Ta=0;p.ib=Number.MAX_VALUE;p.Ea=Number.MAX_VALUE;p.gb=r.Ia;p.eb=y.Ka;p.Xa=e.all;p.jb=b.error;return p}])})(z,z.V("dataConductor"));(function(t,q){q.Y("jsdcIndexedPagerService",["$q","jsdcEventEmitter","jsdcIndexedPageCache","jsdcLoaderService",function(l,n,q,d){function c(){function p(a,b,c){c=parseInt(c,10);isNaN(c)||b[c].then(a.Gb.bind(a,c))}function q(){return b.a.f().j()}function r(){b.a.clear();b.index=null;b.count=0}function v(){function a(a,
c){c&&b.K===u.ma&&(b.count=Math.max(b.count,a))}function c(){t--;t||d()}function d(a){a&&(r=a);!t&&r&&q.resolve(r)}var k=e.index()-e.X(),n=e.index()+e.W(),p=!1,q=l.defer(),r,t;b.a.f().B()===b.a.f().$.ia&&(k=Math.max(0,k));if(null===e.index()||b.na)return q.resolve([]),{exec:q.H};for(;b.a.f().m()<n-k;)p?n--:k++,p=!p;p={};for(t=0;k<=n;k++)t++,p[k]=b.a.load(k),p[k].then(a.bind(null,k)).fb(c);b.a.ga().then(d).catch(q.reject);p.exec=q.H;return p}var e=this,b={index:null,na:!1,Fb:c.ob,qa:c.lb,X:c.xb,W:c.rb,
K:c.Ya,a:new d,count:0};n.call(this);this.Va=u;this.aa=c.aa;this.Z=c.Z;this.da=c.da;this.ba=c.ba;this.$=c.$;this.R=c.R;this.ea=c.ea;b.a.f().Qa(function(a,b){function c(a){return isNaN(a)?null:a}var d,l,n,p,q=e.index();d=a.oa(q);l=a.Ja(q);for(b--;b;)n=c(d[d.length-1]),p=c(l[0]),null!==n&&null!==p?(n=Math.abs(n-q),p=Math.abs(p-q),n>p?l.shift():d.pop()):null!==n?d.pop():l.shift(),b--;return d.concat(l)});b.a.Oa(d.Z.Ha);b.a.f().h("pageSizeChanged",this.b.bind(this,"pageSizeChanged"));b.a.f().h("indexModeChanged",
this.b.bind(this,"indexModeChanged"));b.a.f().h("maxItemsChanged",this.b.bind(this,"maxPagesChanged"));b.a.f().h("cached",this.b.bind(this,"cached"));b.a.f().h("uncached",this.b.bind(this,"removed"));b.a.h("adapterChanged",this.b.bind(this,"adapterChanged"));b.a.h("filterChanged",this.b.bind(this,"filterChanged"));b.a.h("parallelChanged",this.b.bind(this,"parallelChanged"));b.a.h("batchingChanged",this.b.bind(this,"batchingChanged"));b.a.h("batchCancelMode",this.b.bind(this,"batchCancelMode"));b.a.h("existingModeChanged",
this.b.bind(this,"existingModeChanged"));b.a.h("retryDelayChanged",this.b.bind(this,"retryDelayChanged"));b.a.h("retryCountChanged",this.b.bind(this,"retryCountChanged"));b.a.h("dropped",this.b.bind(this,"dropped"));b.a.h("ignored",this.b.bind(this,"ignored"));b.a.h("loaded",this.b.bind(this,"loaded"));this.index=function(){return b.index};this.tb=function(a){var c,d;a=Math.floor(a);if(isNaN(a))throw Error("index MUST be a number");d=b.index;c=l.defer();b.index=a;d!==a&&e.b("indexChanged",a,d);a=
v();Object.keys(a).forEach(p.bind(null,c,a));a.exec.then(c.resolve).catch(c.reject)};this.o=function(){return b.a.o()};this.ra=function(a,c){var f=b.a.ra(a);if(!c){var k=e.I(),l={s:d.Fa,max:d.Ea,$a:!1};"function"===typeof k.info&&(k=k.info(),k.hasOwnProperty("parallel")&&(l.s=k.s),k.hasOwnProperty("max")&&(l.S=k.max),k.hasOwnProperty("dynamic")&&(l.D=k.$a?b.a.f().R.mb:b.a.f().R.clear));e.ca(l)}return f};this.X=function(){return b.X};this.wb=function(a){var c;a=Math.floor(a);if(0<=a)c=b.X,b.X=a,c!==
a&&e.b("padLowChanged",a,c),c=v(),a=l.defer(),Object.keys(c).forEach(p.bind(null,a,c)),c.exec.then(a.resolve).catch(a.reject);else throw Error("padLow MUST be set to a number greater than or equal to 0");};this.W=function(){return b.W};this.vb=function(a){var c;a=Math.floor(a);if(0<=a)c=b.W,b.W=a,c!==a&&e.b("padHighChanged",a,c),c=v(),a=l.defer(),Object.keys(c).forEach(p.bind(null,a,c)),c.exec.then(a.resolve).catch(a.reject);else throw Error("padHigh MUST be set to a number greater than or equal to 0");
};this.K=function(){return b.K};this.sb=function(a){var c;if(u[a])c=b.K,b.K=a,a===u.ma?b.count=b.a.f().T().length:b.count=0,c!==a&&e.b("countModeChanged",a,c);else throw Error('invalid countMode "'+a+'". MUST be one of the following values: '+Object.keys(u).join(", "));};this.filter=function(){return b.a.filter()};this.ja=function(a){t.bb(e.filter(),a)||(b.a.ja(a),r())};this.j=q;this.za=function(a){function c(a,d){a=Math.abs(a.index-b.index);d=Math.abs(d.index-b.index);return a===d?0:a>d?1:-1}var d=
b.a.f(),e;a!==q()&&(d.za(a),d.D()===d.R.clear||0===d.count()?b.index=null:null===d.info(b.index)&&(e=d.T().sort(c),b.index=e[0]),b.count=d.count());return a};this.state=function(){var a;a=b.a.f().state();a=t.extend(a,b.a.state());a.qa=a.m;delete a.m;return a=t.extend(a,{index:e.index(),X:e.X(),W:e.W(),K:e.K(),filter:e.filter()})};this.ca=function(a){if(!a||"object"!==typeof a)throw Error("supplied state MUST be an object");b.a.f().ca(a);b.a.ca(a);b.na=!0;a.hasOwnProperty("filter")&&e.ja(a.filter);
a.hasOwnProperty("index")&&e.tb(a.index);a.hasOwnProperty("maxPages")&&e.ub(a.qa);a.hasOwnProperty("padLow")&&e.wb(a.X);a.hasOwnProperty("padHigh")&&e.vb(a.W);b.na=!1;a.hasOwnProperty("countMode")&&e.sb(a.K);a=v();return a=a.exec};this.D=b.a.f().D;this.Ba=b.a.f().Ba;this.B=b.a.f().B;this.wa=b.a.f().wa;this.qa=b.a.f().m;this.ub=b.a.f().Pa;this.I=b.a.I;this.s=b.a.s;this.Aa=b.a.Aa;this.J=b.a.J;this.ua=b.a.ua;this.S=b.a.S;this.ta=b.a.ta;this.w=b.a.w;this.sa=b.a.sa;this.L=b.a.L;this.xa=b.a.xa;this.U=b.a.U;
this.ya=b.a.ya;this.M=b.a.M;this.Ca=b.a.Ca;this.N=b.a.N;this.Da=b.a.Da;this.A=b.a.A;this.va=b.a.va;this.clear=r;this.page=function(a){a=b.a.info(a);var c;a?c={index:a.index,data:a.T,g:a.Ma||a.g||a.i,cancel:a.cancel}:c=null;return c};this.remove=b.a.f().yb;this.count=function(){var a=l.defer();switch(e.K()){case u.nb:a.resolve(null);break;case u.o:if(b.a.I().count)b.a.I().count(e.filter()).then(a.resolve).catch(a.reject);else throw Error("The currently set adapter does not support count");break;case u.fixed:case u.ma:a.resolve(b.count);
break;default:throw Error('Unrecognised count mode "'+e.K()+'"');}return a.H}}var u=c.Va={nb:"none",o:"adapter",fixed:"fixed",ma:"detect"};c.Ya=u.o;c.xb=0;c.rb=0;c.ob=1;c.lb=Number.fa||Number.MAX_VALUE;c.aa=d.aa;c.Z=d.Z;c.da=d.da;c.ea=d.ea;c.ba=q.ba;c.$=q.$;c.R=q.R;return c}])})(z,z.V("dataConductor"))})})(define);
